<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{{ title or site.title or "AiA" }}</title>
  <style>
    {% set theme = site.theme or {} %}
    :root {
      --bg: {{ theme.bg or '#0b0b0c' }};
      --text: {{ theme.text or '#e7e7ea' }};
      --muted: {{ theme.muted or '#a4a4ad' }};
      --accent: {{ theme.accent or '#7c5cff' }};
      --card: {{ theme.card or '#151518' }};
      --card-2: {{ theme.card_2 or '#1c1c21' }};
      --border: {{ theme.border or '#2a2a31' }};
      --font-family: {{ theme.font_family or "system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif" }};
      --font-size: {{ (theme.font_size or 16) }}px;
      --content-max: {{ (theme.content_max_width or 900) }}px;
      --nav-max: {{ (theme.nav_max_width or 1100) }}px;
      --radius: {{ (theme.border_radius or 12) }}px;
      --nav-bg: {{ theme.nav_background or 'rgba(11,11,12,0.7)' }};
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; }
    body { background: var(--bg); color: var(--text); font-size: var(--font-size); line-height: 1.6; font-family: var(--font-family); }
    a { color: inherit; text-decoration: none; }
    img { max-width: 100%; height: auto; display: block; }

    .nav { position: sticky; top: 0; z-index: 50; background: var(--nav-bg); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border); }
    .nav-inner { max-width: var(--nav-max); margin: 0 auto; padding: 0.75rem 1rem; display: flex; align-items: center; gap: 1rem; }
    .brand { font-weight: 700; letter-spacing: 0.2px; color: var(--text); padding: 0.25rem 0.5rem; border-radius: 8px; }
    .brand:hover { color: white; }
    .menu { list-style: none; margin: 0; padding: 0; display: flex; gap: 1rem; }
    .menu > li { position: relative; }
    .menu > li > a { padding: 0.4rem 0.5rem; border-radius: var(--radius); color: var(--muted); display: inline-block; }
    .menu > li > a:hover { color: white; background: var(--card); }
    .has-children > a::after { content: "â–¾"; margin-left: 0.35rem; font-size: 0.8em; }
    .submenu { display: none; position: absolute; left: 0; top: 100%; min-width: 220px; background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 0.5rem; box-shadow: 0 10px 30px rgba(0,0,0,0.35); }
    .submenu li { list-style: none; }
    .submenu a { display: block; padding: 0.5rem 0.6rem; border-radius: 8px; color: var(--text); }
    .submenu a:hover { background: var(--card-2); color: white; }
    .menu > li:hover .submenu { display: block; }
    .nav-right { margin-left: auto; display: flex; align-items: center; gap: 0.75rem; }
    .chip { padding: 0.35rem 0.6rem; background: var(--card); border: 1px solid var(--border); border-radius: 100px; color: var(--muted); font-size: 0.9rem; }
    .chip:hover { background: var(--card-2); color: white; }

    .hero { position: relative; min-height: 25vh; display: grid; place-items: center; background-size: cover; background-position: center; }
    .hero-overlay {
      position: absolute;
      inset: 0;
      /* Accent glow + strong bottom fade to bg for short heroes */
      background:
        radial-gradient(800px 400px at 20% 10%, rgba(124,92,255,0.20), rgba(124,92,255,0) 60%),
        linear-gradient(to bottom, rgba(11,11,12,0.05) 0%, rgba(11,11,12,0.65) 45%, var(--bg) 100%);
      pointer-events: none;
    }
    .hero-content { position: relative; z-index: 1; text-align: center; padding: 2rem 1rem; max-width: 900px; }
    .hero h1 { font-size: clamp(1.8rem, 4vw, 3rem); margin: 0 0 0.5rem; letter-spacing: -0.02em; }
    .hero p { color: var(--muted); font-size: clamp(1rem, 1.8vw, 1.15rem); margin: 0 auto; max-width: 60ch; }

    main { max-width: var(--content-max); margin: 2rem auto; padding: 0 1rem 3rem; }
    .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 0.75rem; }
    .gallery figure { margin: 0; border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; background: var(--card); }
    .page-hero { margin: 1rem 0 2rem; border-radius: var(--radius); overflow: hidden; border: 0; background: transparent; position: relative; }
    .page-hero img, .gallery figure img { width: 100%; height: auto; object-fit: contain; }
    .gallery figcaption { padding: 0.5rem 0.6rem; color: var(--muted); font-size: 0.9rem; }
    .prose::after { content: ""; display: block; clear: both; }
    .prose img { max-width: 100%; height: auto; }
    /* Image fade utilities (applied on figure.page-hero) */
    .img-fade-top { -webkit-mask-image: linear-gradient(to bottom, transparent, black 10%); mask-image: linear-gradient(to bottom, transparent, black 10%); }
    .img-fade-bottom { -webkit-mask-image: linear-gradient(to top, transparent, black 10%); mask-image: linear-gradient(to top, transparent, black 10%); }
    .img-fade-both { -webkit-mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent); mask-image: linear-gradient(to bottom, transparent, black 10%, black 90%, transparent); }
    .img-fade-left { -webkit-mask-image: linear-gradient(to right, transparent, black 10%); mask-image: linear-gradient(to right, transparent, black 10%); }
    .img-fade-right { -webkit-mask-image: linear-gradient(to left, transparent, black 10%); mask-image: linear-gradient(to left, transparent, black 10%); }
    .img-fade-sides { -webkit-mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent); }
    .img-fade-all {
      -webkit-mask-image:
        linear-gradient(to right, transparent, black 10%, black 90%, transparent),
        linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);
      -webkit-mask-composite: source-in;
      mask-image:
        linear-gradient(to right, transparent, black 10%, black 90%, transparent),
        linear-gradient(to bottom, transparent, black 10%, black 90%, transparent);
      mask-composite: intersect;
    }
    .img-fade-radial { /* overlay only */ }
    .page-hero.img-fade-radial::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background: radial-gradient(farthest-side at 50% 50%,
        rgba(11,11,12,0) 55%,
        rgba(11,11,12,0.25) 75%,
        rgba(11,11,12,0.55) 90%,
        var(--bg) 100%);
      mix-blend-mode: normal;
    }
    .page-hero.img-fade-radial::after {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background:
        radial-gradient(160% 160% at 50% 50%, rgba(11,11,12,0) 60%, rgba(11,11,12,0.5) 85%, var(--bg) 100%);
    }
  </style>
  <meta name="theme-color" content="{{ (site.theme and site.theme.bg) or '#0b0b0c' }}">
  {% set __accent = (site.theme and site.theme.accent) or '#7c5cff' %}
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Ccircle cx='8' cy='8' r='8' fill='{{ __accent | replace('#','%23') }}'/%3E%3C/svg%3E">
</head>
<body>
  <header class="nav">
    <div class="nav-inner">
      {% set __logo = site.logo %}
      {% if __logo and __logo[0] != '/' %}{% set __logo = '/assets/uploads/' ~ __logo %}{% endif %}
      {% if __logo %}{% set __logo = __logo | replace('/AiA/assets/', '/assets/') %}{% endif %}
      <a class="brand" href="{{ '/' | url }}">
        {% if __logo %}
          <img src="{{ __logo | url }}" alt="{{ site.title or 'AiA' }}" style="height:28px;width:auto;display:block;" />
        {% else %}
          {{ site.title or 'AiA' }}
        {% endif %}
      </a>
      <ul class="menu">
        {% if navigation and navigation.items %}
          {% for item in navigation.items %}
            <li class="{% if item.children and (item.children | length) %}has-children{% endif %}">
              <a href="{{ item.url | url }}">{{ item.label }}</a>
              {% if item.children and (item.children | length) %}
                <ul class="submenu">
                  {% for child in item.children %}
                    <li><a href="{{ child.url | url }}">{{ child.label }}</a></li>
                  {% endfor %}
                </ul>
              {% endif %}
            </li>
          {% endfor %}
        {% else %}
          <li><a href="{{ '/' | url }}">Home</a></li>
          <li><a href="{{ '/posts/' | url }}">Blog</a></li>
        {% endif %}
      </ul>
      <div class="nav-right">
        <a class="chip" href="{{ '/admin/' | url }}">Admin</a>
      </div>
    </div>
  </header>

  {% set hasBlocks = blocks and (blocks | length) %}
  {% if not hasBlocks %}
    {% set __hero = hero_image %}
    {% if __hero and __hero[0] != '/' %}{% set __hero = '/assets/uploads/' ~ __hero %}{% endif %}
    {% if __hero %}{% set __hero = __hero | replace('/AiA/assets/', '/assets/') %}{% endif %}
    <section class="hero" {% if __hero %}style="background-image: url('{{ __hero | url }}');"{% endif %}>
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <h1>{{ hero_heading or title }}</h1>
        {% if hero_text %}<p>{{ hero_text }}</p>{% endif %}
      </div>
    </section>
  {% endif %}

  <main>
    {% set __baseDir = '/assets/uploads/' %}
    {% if hasBlocks %}
      {% for block in blocks %}
        {% if block.type == 'hero' %}
          {% set __himg = block.hero_image %}
          {% if __himg and __himg[0] != '/' %}{% set __himg = __baseDir ~ __himg %}{% endif %}
          {% if __himg %}{% set __himg = __himg | replace('/AiA/assets/', '/assets/') %}{% endif %}
          <section class="hero" {% if __himg %}style="background-image: url('{{ __himg | url }}');"{% endif %}>
            <div class="hero-overlay"></div>
            <div class="hero-content">
              <h1>{{ block.hero_heading or title }}</h1>
              {% if block.hero_text %}<p>{{ block.hero_text }}</p>{% endif %}
            </div>
          </section>
        {% elif block.type == 'richtext' %}
          <div class="prose">
            {{ block.content | markdown | fixImgUrls | safe }}
          </div>
        {% elif block.type == 'image_block' and block.image %}
          {% set __bimg = block.image %}
          {% if __bimg and __bimg[0] != '/' %}{% set __bimg = __baseDir ~ __bimg %}{% endif %}
          {% if __bimg %}{% set __bimg = __bimg | replace('/AiA/assets/', '/assets/') %}{% endif %}
          {% set __fadeClass = '' %}
          {% if block.gradient == 'top-bottom' or block.gradient == 'both' %}{% set __fadeClass = 'img-fade-both' %}
          {% elif block.gradient == 'left-right' or block.gradient == 'sides' %}{% set __fadeClass = 'img-fade-sides' %}
          {% elif block.gradient == 'all' %}{% set __fadeClass = 'img-fade-all' %}
          {% elif block.gradient == 'radial' %}{% set __fadeClass = 'img-fade-radial' %}
          {% endif %}
          <figure class="page-hero {{ __fadeClass }}">
            <img src="{{ __bimg | url }}" alt="" {% if block.height %}style="width: 100%; height: {{ block.height }}px; object-fit: cover; object-position: center;"{% endif %} />
          </figure>
        {% elif block.type == 'two_column' %}
          <div class="grid-2">
            <div class="prose">{{ block.left | markdown | fixImgUrls | safe }}</div>
            <div class="prose">{{ block.right | markdown | fixImgUrls | safe }}</div>
          </div>
        {% elif block.type == 'cta' and block.url %}
          <p><a class="chip" href="{{ block.url | url }}">{{ block.label or block.text or 'Learn more' }}</a></p>
        {% endif %}
      {% endfor %}
    {% else %}
      {% if image %}
        {% set __img = image %}
        {% if __img and __img[0] != '/' %}{% set __img = __baseDir ~ __img %}{% endif %}
        {% if __img %}{% set __img = __img | replace('/AiA/assets/', '/assets/') %}{% endif %}
        <figure class="page-hero"><img src="{{ __img | url }}" alt="" /></figure>
      {% endif %}
      {% if intro %}
        <div class="intro">{{ intro }}</div>
      {% endif %}
      <div class="prose">
        {{ content | fixImgUrls | safe }}
      </div>
    {% endif %}
  </main>
</body>
</html>



